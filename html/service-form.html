<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <meta name="author" content="Leah Dykema">
        <meta name="description" content="Request services with iAccessAbility.">
        <meta name="theme-color" content="#eee" id="theme-color-meta">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta property="og:image" name="image" content="https://iaccessabilityservices.com/img/favicon.png">
        <meta property="og:title" content="Request Services - iAccessAbility">
        <meta property="og:description" content="Request services with iAccessAbility.">
        <meta property="og:url" content="https://support.iaccessabilityservices.com/html/service-form.html">
        <meta property="og:type" content="website">
        <link rel="shortcut icon" type="image/x-icon" href="https://support.iaccessabilityservices.com/media/favicon.ico">
        <link rel="apple-touch-icon" type="image/x-icon" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="16x16" href="https://support.iaccessabilityservices.com/media/favicon.ico">
        <link rel="apple-touch-icon" type="image/png" sizes="32x32" href="https://support.iaccessabilityservices.com/media/favicon.ico">
        <link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://support.iaccessabilityservices.com/media/favicon.ico">
        <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://support.iaccessabilityservices.com/media/favicon.ico">
        <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="167x167" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="192x192" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <link rel="apple-touch-icon" type="image/png" sizes="512x512" href="https://support.iaccessabilityservices.com/media/favicon.png">
        <title>Request Services - iAccessAbility</title>
        <link rel="stylesheet" href="../stylesheets/services-form.css">
        <link rel="stylesheet" href="https://iaccessabilityservices.com/stylesheets/accessibility.css">
        <link rel="stylesheet" href="https://iaccessabilityservices.com/navbar/navbar.css">
        <link rel="manifest" href="https://iaccessabilityservices.com/manifest.json">
    </head>
    <body>
        <!-- Navigation -->
        <div class="nav-container" data-role="header" data-position="fixed">
            <nav>
                <!-- Top row: menu button on left, logo on right -->
                <div class="mobile-header">
                    <!-- iAccessAbility -->
                    <div class="logo-container">
                        <a href="https://iaccessabilityservices.com" aria-label="Home"><img class="link-logo" src="https://iaccessabilityservices.com/img/logo-colored.svg" alt="I Access Ability"></a>
                        <a href="https://iaccessabilityservices.com" class="links"><h1 class="name" aria-label="I Access Ability">iAccessAbility</h1></a>
                    </div>
                    <!-- Mobile Menu Toggle Button -->
                    <button class="menu-toggle" aria-expanded="false" aria-label="Toggle menu">
                        <span class="menu-icon-container">
                            <span class="menu-line"></span>
                            <span class="menu-line"></span>
                        </span>
                    </button>
                </div>
                <!-- Desktop Navigation -->
                <ul class="desktop-nav">
                    <li><a href="https://iaccessabilityservices.com"><img class="link-logo" src="https://iaccessabilityservices.com/img/logo-colored.svg" alt="I Access Ability"></a></li>
                    <li><a href="https://iaccessabilityservices.com/news/">News</a></li>
                    <li><a href="https://iaccessabilityservices.com/blog/">Blog</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/recommendations.html">Recommendations</a></li>
                    <li><a href="https://support.iaccessabilityservices.com">Support</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/about.html">About</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/connect.html">Connect</a></li>
                </ul>
                <!-- Mobile Navigation (initially hidden) -->
                <ul id="mobile-menu" class="mobile-nav" aria-hidden="true">
                    <li><a href="https://iaccessabilityservices.com" tabindex="-1">Home</a></li>
                    <li><a href="https://iaccessabilityservices.com/news/" tabindex="-1">News</a></li>
                    <li><a href="https://iaccessabilityservices.com/blog/" tabindex="-1">Blog</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/recommendations.html" tabindex="-1">Recommendations</a></li>
                    <li><a href="https://support.iaccessabilityservices.com" tabindex="-1">Support</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/about.html" tabindex="-1">About</a></li>
                    <li><a href="https://iaccessabilityservices.com/html/connect.html" tabindex="-1">Connect</a></li>
                </ul>
            </nav>
        </div>
        <!-- Services Form -->
        <main class="site">
            <h2>Request Services</h2>
            <div class="form">
                <form id="ServiceRequest">
                    <div class="form-row">
                        <label>First Name&#58;</label>
                        <input type="text" name="First Name" id="firstName" required maxlength="15" placeholder="John" tabindex="0">
                    </div>
                    <div class="form-row">
                        <label>Last Name&#58;</label>
                        <input type="text" name="Last Name" id="lastName" required maxlength="15" placeholder="Appleseed" tabindex="0">
                    </div>
                    <div class="form-row">
                        <label>Phone&#58;</label>
                        <input type="tel" name="Phone Number" id="phoneNumber" required placeholder="(555) 555-5555" tabindex="0">
                    </div>
                    <div class="form-row">
                    <label>Email&#58;</label>
                        <input type="email" name="Email Address" id="email" required placeholder="john@example.com" tabindex="0">
                    </div>
                    <div class="form-row">
                        <label>Service Request&#58;</label>
                        <select name="Service" id="serviceType" required tabindex="0">
                            <option selected disabled>Select a Service</option>
                            <option value="Tech Support" tabindex="0">Tech Support</option>
                            <option value="Personalized Consulting" tabindex="0">Buying Consulting</option>
                            <option value="One-on-One Training" tabindex="0">One-on-One Training</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Communication Preference&#58;</label>
                        <select name="Communication" id="communicationType" required tabindex="0">
                            <option selected disabled>Select a Method to Communicate</option>
                            <option value="SMS" tabindex="0">Direct Text</option>
                            <option value="call" tabindex="0">Phone Call</option>
                            <option value="email" tabindex="0">Email</option>
                            <option value="WhatsApp Text" tabindex="0">WhatsApp Text</option>
                            <option value="WhatsApp Call" tabindex="0">WhatsApp Call</option>
                            <option value="Telegram Text" tabindex="0">Telegram Text</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Time Zone&#58;</label>
                        <select name="Time Zone" id="timeZone" required tabindex="0">
                            <option selected disabled>Select Your Time Zone</option>
                            <option value="Pacific" tabindex="0">Pacific Time &#40;PT&#41;</option>
                            <option value="Mountain" tabindex="0">Mountain Time &#40;MT&#41;</option>
                            <option value="Central" tabindex="0">Central Time &#40;CT&#41;</option>
                            <option value="Eastern" tabindex="0">Eastern Time &#40;ET&#41;</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Payment Method&#58;</label>
                        <select name="Payment Method" id="paymentMethod" required tabindex="0">
                            <option selected disabled>Select a Payment Method</option>
                            <option value="Venmo" tabindex="0">Venmo</option>
                            <option value="PayPal" tabindex="0">PayPal</option>
                        </select>
                    </div>
                    <div class="form-row">
                        <label>Username&#58;</label>
                        <input type="text" name="Username" id="username" placeholder="@johnappleseed" tabindex="0">
                    </div>
                    <div class="form-row">
                        <div class="agree-section">
                            <label for="agreement">
                                <input type="checkbox" id="agreement" required tabindex="0">
                                I agree to use Venmo or PayPal to pay for my services with iAccessAbility.
                            </label>
                        </div>
                    </div>
                    <input type="hidden" name="timestamp" id="timestamp" aria-hidden="true">
                    <button class="submit" type="submit" tabindex="3" disabled>
                        Request Service
                    </button>
                </form>
            </div>
            <br>
            <footer>
                <p class="info"> iAccessAbility services are available only to individuals located in the United States&#46; In&#45;person sessions are offered exclusively in or near Pella&#44; Iowa&#46; All online sessions are scheduled in Central Time&#46;
                For secure transactions&#44; we accept payments through PayPal and Venmo&#46;
                </p>
                <p class="info">For any questions&#44; please contact iAccessAbility at&#58; <a class="links" href="mailto:support@iaccessabilityservices.com?subject=Request%20Service%20Inquiries" tabindex="0">support&#64;iAccessAbillityServices&#46;com</a></p>
            </footer>
        </main>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const form = document.getElementById("ServiceRequest");
                const submitButton = form.querySelector("button[type='submit']");
                function validateForm() {
                    let isValid = true;
                    form.querySelectorAll("[required]").forEach(field => {
                        if (field.type === "checkbox" && !field.checked) {
                            isValid = false;
                        } else if (field.type !== "checkbox" && !field.value.trim()) {
                            isValid = false;
                        }
                    });
                    submitButton.disabled = !isValid;
                }
                form.addEventListener("input", validateForm);
                form.addEventListener("change", validateForm);
            });
        </script>
        <script>
            const scriptURL = "https://script.google.com/macros/s/AKfycbyT8mUAHxui6Iynn0p2HUMXJj98174dDmqgTIXMusQM6qmkKp2hrPGo0UTbPAeeFG8C/exec";
            const isDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
            const form = document.forms["ServiceRequest"];
            const submitButton = form.querySelector('button[type="submit"]');
            function formatPhoneNumber(phone) {
                const cleaned = ('' + phone).replace(/\D/g, '');
                const match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);
                if (match) {
                    return `(${match[1]}) ${match[2]}-${match[3]}`;
                }
                return phone;
            }
            form.addEventListener("submit", (e) => {
                e.preventDefault();
                submitButton.disabled = true;
                const now = new Date();
                const optionsTime = {
                    hour: 'numeric',
                    minute: 'numeric',
                    hour12: true,
                    timeZone: 'America/Chicago'
                };
                const optionsDate = {
                    month: 'numeric',
                    day: 'numeric',
                    year: 'numeric',
                    timeZone: 'America/Chicago'
                };
                document.getElementById("timestamp").value = now.toLocaleTimeString('en-US', optionsTime) + ' (CT) ' + now.toLocaleDateString('en-US', optionsDate);
                const formData = new FormData(form);
                const rawPhone = formData.get("Phone Number");
                if (rawPhone) formData.set("Phone Number", formatPhoneNumber(rawPhone));
                formData.append("Agreement", document.getElementById("agreement").checked ? "Yes" : "No");
                const params = new URLSearchParams(formData);
                fetch(scriptURL, {
                    method: "POST",
                    headers: { "Content-Type": "application/x-www-form-urlencoded" },
                    body: params
                })
                .then(response => response.json())
                .then(data => {
                    if(data.result === "success") {
                        Swal.fire({
                            title: "Done",
                            text: "Submitted Successfully.",
                            icon: "success",
                            background: isDark ? "#222" : "#fff",
                            color: isDark ? "#eee" : "#000",
                            confirmButtonColor: isDark ? "#4da3ff" : "#0063cc",
                            customClass: { icon: 'custom-success-icon' }
                        });
                        form.reset();
                    } else {
                        throw new Error("Submission failed");
                    }
                })
                .catch(error => {
                    Swal.fire({
                        title: "Error",
                        text: "Something went wrong. Please try again! If this issue persists, please report it to report@iAccessAbilityServices.com.",
                        icon: "error",
                        background: isDark ? "#222" : "#fff",
                        color: isDark ? "#eee" : "#000",
                        confirmButtonColor: isDark ? "#4da3ff" : "#0063cc"
                    });
                    submitButton.disabled = false;
                });
            });
        </script>
        <script src="https://iaccessabilityservices.com/javascript/screen-reader-support.js"></script>
        <script src="https://iaccessabilityservices.com/navbar/navbar.js"></script>
        <script src="https://iaccessabilityservices.com/javascript/pwa.js"></script>
        <script src="https://iaccessabilityservices.com/javascript/dyslexic.js"></script>
    </body>
</html>
